
/*
	DECLARE @IDGRUPO VARCHAR(MAX) = '1,2,3,4,5,6,7,8,9,10,11,12,13,14'	
	EXEC PROC_CHAT_GRUPO_HORARIO_AUX_TABLE_TEMP @IDGRUPO
*/
ALTER PROC PROC_CHAT_GRUPO_HORARIO_AUX_TABLE_TEMP
(
	@IDGRUPO VARCHAR(MAX)
)
AS 
	BEGIN
	DECLARE @TABLE TABLE(IDGRUPOCHAT INT,DATACRIACAO INT,HORAMASK VARCHAR(MAX),HORA INT,MINUTO INT,ENTRANTES INT,RECEBIDOS INT,ABONDONADOS INT,TEMPO_MEDIO_ABONDONO INT,OFFILINE INT,TEMPO_MEDIO_ESPERA INT,TEMPO_MEDIO_ATENDIMENTO INT, ATENDIMENTO_ATE_30_SEG INT)
	DECLARE @TABLE1 TABLE(IDGRUPOCHAT INT,DATACRIACAO INT,HORAMASK VARCHAR(MAX),HORA INT,MINUTO INT,ENTRANTES INT,RECEBIDOS INT,ABONDONADOS INT,TEMPO_MEDIO_ABONDONO INT,OFFILINE INT,TEMPO_MEDIO_ESPERA INT,TEMPO_MEDIO_ATENDIMENTO INT, ATENDIMENTO_ATE_30_SEG INT)

	INSERT INTO @TABLE VALUES(0,0,'00:00hs - 00:29hs',0,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'00:30hs - 00:59hs',0,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'01:00hs - 01:29hs',1,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'01:30hs - 01:59hs',1,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'02:00hs - 02:29hs',2,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'02:30hs - 02:59hs',2,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'03:00hs - 03:29hs',3,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'03:30hs - 03:59hs',3,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'04:00hs - 04:29hs',4,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'04:30hs - 04:59hs',4,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'05:00hs - 05:29hs',5,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'05:30hs - 05:59hs',5,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'06:00hs - 06:29hs',6,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'06:30hs - 06:59hs',6,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'07:00hs - 07:29hs',7,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'07:30hs - 07:59hs',7,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'08:00hs - 08:29hs',8,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'08:30hs - 08:59hs',8,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'09:00hs - 09:29hs',9,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'09:30hs - 09:59hs',9,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'10:00hs - 10:29hs',10,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'10:30hs - 10:59hs',10,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'11:00hs - 11:29hs',11,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'11:30hs - 11:59hs',11,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'12:00hs - 12:29hs',12,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'12:30hs - 12:59hs',12,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'13:00hs - 13:29hs',13,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'13:30hs - 13:59hs',13,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'14:00hs - 14:29hs',14,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'14:30hs - 14:59hs',14,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'15:00hs - 15:29hs',15,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'15:30hs - 15:59hs',15,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'16:00hs - 16:29hs',16,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'16:30hs - 16:59hs',16,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'17:00hs - 17:29hs',17,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'17:30hs - 17:59hs',17,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'18:00hs - 18:29hs',18,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'18:30hs - 18:59hs',18,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'19:00hs - 19:29hs',19,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'19:30hs - 19:59hs',19,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'20:00hs - 20:29hs',20,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'20:30hs - 20:59hs',20,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'21:00hs - 21:29hs',21,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'21:30hs - 21:59hs',21,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'22:00hs - 22:29hs',22,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'22:30hs - 22:59hs',22,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'23:00hs - 23:29hs',23,0,0,0,0,0,0,0,0,0)
	INSERT INTO @TABLE VALUES(0,0,'23:30hs - 23:59hs',23,0,0,0,0,0,0,0,0,0)

	DECLARE @ID_GRUPO INT
	DECLARE CURSOR_GRUPO CURSOR FOR 
	SELECT INTVALUE FROM [DBO].[CSVTOINT](@IDGRUPO)

	OPEN CURSOR_GRUPO;

	FETCH NEXT FROM CURSOR_GRUPO INTO @ID_GRUPO

	WHILE @@FETCH_STATUS = 0
		BEGIN
		    --PRINT  CAST(@ID_GRUPO AS varchar)
			INSERT INTO @TABLE1
			SELECT @ID_GRUPO,DATACRIACAO,HORAMASK,HORA,MINUTO,ENTRANTES,RECEBIDOS,ABONDONADOS,TEMPO_MEDIO_ABONDONO,OFFILINE,TEMPO_MEDIO_ESPERA,TEMPO_MEDIO_ATENDIMENTO,ATENDIMENTO_ATE_30_SEG FROM @TABLE
		    FETCH NEXT FROM CURSOR_GRUPO INTO  @ID_GRUPO
		END;

	CLOSE CURSOR_GRUPO;
	
	DEALLOCATE CURSOR_GRUPO;

	SELECT * FROM @TABLE1 ORDER BY IDGRUPOCHAT,HORAMASK
	END
